---
title: "04_plots_mean_variance"
output: html_document
date: "2025-11-21"
---

```{r mean curves}

rmarkdown::render("04_mean_and_variance_functions.Rmd", envir = globalenv(), quiet = TRUE)

par(mar = c(5, 4, 4, 10))  
grid <- seq(min(Time), max(Time), length.out = 200)
ylim_mean <- range(unlist(mean_values_list))

plot(grid, mean_values_list[[1]], type="n", ylim=ylim_mean,
xlab="Time (sec)", ylab="fEPSP", main="Mean Curves for All Groups")

for (i in seq_along(mean_values_list)) {
lines(grid, mean_values_list[[i]], col=colors[i], lwd=2)
}

grid()
legend("topright", inset = c(-0.45, 0), xpd = TRUE, legend=groups_names, col=colors, lwd=2, bty="n", cex=0.8)


```




```{r variance curves}

par(mar = c(5, 4, 4, 10))

rmarkdown::render("04_mean_and_variance_functions.Rmd", envir = globalenv(), quiet = TRUE)

var_values_list_aligned <- lapply(var_values_list, function(x) {
  approx(x = seq_along(x), y = x, xout = seq_len(length(grid)))$y
})

ylim_var <- range(unlist(var_values_list_aligned), na.rm = TRUE)

plot(grid, var_values_list_aligned[[1]], type="n", ylim=ylim_var,
     xlab="Time (sec)", ylab="Variance", main="Variance Curves for All Groups")

for (i in seq_along(var_values_list_aligned)) {
  lines(grid, var_values_list_aligned[[i]], col=colors[i], lwd=2)
}

grid()
legend("topright",inset = c(-0.45, 0), xpd = TRUE, legend=groups_names, col=colors, lwd=2, bty="n", cex=0.8)

```








