---
title: "Smoothed Functional Data â€” Group Curves"
output: html_document
date: "2025-11-21"
---

```{r}

rmarkdown::render("01a_data_preparation.Rmd", envir = globalenv(), quiet = TRUE)
rmarkdown::render("01b_data_preparation.Rmd", envir = globalenv(), quiet = TRUE)


groups_names <- c(
  "Males WT Juvenile","Males HRM Juvenile","Females WT Juvenile","Females HRM Juvenile",
  "Males WT Adolescent","Males HRM Adolescent","Females WT Adolescent","Females HRM Adolescent","Males WT Adult","Males HRM Adult","Females WT Adult")



colors <- c(
  # Juvenile - BLUE family
   "#00427A",  "#00427A",  "#4F8FD3",  "#4F8FD3",  

  # Adolescent - ORANGE family
   "yellow3", "yellow3",  "#DC5700",  "#DC5700",  

  # Adult - GREEN family
   "green3","green3","#1F7F1F"
  
)   


lty <- c(1,2,1,2, 1,2,1,2, 1,2,1)


#-------------------------Plot group's curves------------------------


grid <- seq(min(Time), max(Time), length.out = 200)

all_vals <- unlist(lapply(all_fd_groups, function(fd) eval.fd(grid, fd)))
ylim_global <- range(all_vals)
ylim_global


plot_gp_curves <- function(fd_gp, title_gp, col, lty,
                         ylim_global = NULL) {
  
  
  grid <- seq(min(Time), max(Time), length.out = 200)
  mat  <- eval.fd(grid, fd_gp)    
  
  #first curves
  plot(grid, mat[, 1],type='l', col = col,lty=lty, lwd = 2,
       main = title_gp, xlab = "Time (sec)", ylab = "fESPS % of baseline",
       ylim = ylim_global)
  
  #adding the other curves of the group
  if (ncol(mat) > 1) {
    for (i in 2:ncol(mat)) {
      lines(grid, mat[, i],lty= lty, col = col, lwd = 2)
    }
  }
}



for (i in 1:length(all_fd_groups)) {
  plot_gp_curves(
    fd_gp = all_fd_groups[[i]],
    title_gp = groups_names[i],
    col = colors[i],
    lty =lty[i],
    ylim_global = ylim_global
    
    
  )
  abline(h = 150, col = "black", lwd = 2, lty = 2)
  grid()
}

```

