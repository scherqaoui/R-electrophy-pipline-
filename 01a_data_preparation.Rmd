---
title: "data preparation"
output: html_document
date: "2025-11-20"
---




```{r raw data}
library(fda)
library(fda.usc)
library(readxl)
library(dplyr)
library(tidyr)
library(fdANOVA)

data_juv <- read_excel("C:/Users/bs/Desktop/R-electrophy-pipline-/all data.xlsx", sheet = "juv")
data_ado <- read_excel("C:/Users/bs/Desktop/R-electrophy-pipline-/all data.xlsx", sheet = "ado")
data_adu <- read_excel("C:/Users/bs/Desktop/R-electrophy-pipline-/all data.xlsx", sheet = "adu")
#data_age <- read_excel("C:/Users/bs/Desktop/R-electrophy-pipline-/all data.xlsx", sheet = "age")

clean_data <- function(data, time_min, time_max, drop_cols) {
  data <- data[, -drop_cols]
  colnames(data) <- as.character(unlist(data[5, ]))
  data <- data[-c(1:6), ]
  colnames(data)[1] <- "Time"
  data$Time <- as.numeric(data$Time)
  data[-1] <- lapply(data[-1], as.numeric)
  
  data %>%
    filter(Time >= time_min & Time <= time_max) %>%
    filter(complete.cases(.))
}

cleaned_data_juv <- clean_data(data_juv, 10, 2400, c(1:4,6,15,26:32,43,44))
cleaned_data_ado <- clean_data(data_ado, 10, 2390, c(1:4,16,23,26,37))
cleaned_data_adu <- clean_data(data_adu, 10, 2390, c(1:4,6,11,17,20,28,29,36,38,39,43))

Time <- cleaned_data_juv$Time

matrix_juv <- as.matrix(cleaned_data_juv[, -1]) 
matrix_ado <- as.matrix(cleaned_data_ado[, -1]) 
matrix_adu <- as.matrix(cleaned_data_adu[, -1]) 

all_groups <- list(
  # Juvenile
  malesWTjuv    = matrix_juv[, 1:8],
  malesHRMjuv   = matrix_juv[, 9:18],
  femalesWTjuv  = matrix_juv[, 19:28],
  femalesHRMjuv = matrix_juv[, 29:40],

  # Adolescent
  malesWTado    = matrix_ado[, 1:10],
  malesHRMado   = matrix_ado[, 11:18],
  femalesWTado  = matrix_ado[, 19:28],
  femalesHRMado = matrix_ado[, 29:37],

  # Adult
  malesWTadu    = matrix_adu[, 1:9],
  malesHRMadu   = matrix_adu[, 10:18],
  femalesWTadu  = matrix_adu[, 19:25],
  femalesHRMadu  = matrix_adu[, 26:33]
  
)


groups_names <- c(
  "Males WT Juvenile","Males HRM Juvenile","Females WT Juvenile","Females HRM Juvenile",
  "Males WT Adolescent","Males HRM Adolescent","Females WT Adolescent","Females HRM Adolescent","Males WT Adult","Males HRM Adult","Females WT Adult", "Females HRM Adult")



colors <- c(
  # Juvenile - BLUE family
   "#00427A",  "#00427A",  "#4F8FD3",  "#4F8FD3",  

  # Adolescent - ORANGE family
   "yellow3", "yellow3",  "#DC5700",  "#DC5700",  

  # Adult - GREEN family
   "green3","green3","#1F7F1F","#1F7F1F"
  
)   


lty <- c(1,2,1,2, 1,2,1,2, 1,2,1,2)



```















